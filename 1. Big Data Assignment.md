# Big Data Assignment
## _Samantha Knox C 1000466_

## Contents:
| Part 1 
| Part 2 
| Part 3 
| Appendix A 
| Appendix B |

## - ✨Part 1✨ 

- Login: root
- Password: Sammy100!
- Scripts are saved in HDFS (maria_dev/maria_dev) in this location: root/root/user/Uni_Assignment (apologies for the other files, I was unable to delete) 
- See Appendix A for copy of Pig Scripts (TWEET, RETWEET, MENTIONS, HASHTAGS_TIMELINES and TWEET_RETWEET)
- A copy of the output files I created (TWEET_RETWEET & TWEET_MENTIONS) for part 2 can also be found here:
https://github.com/Knoxyherself/Big-Data-Assignment

## - ✨Part  2✨

Python Spark funtion can be found here:
http://localhost:9995/#/notebook/2G1CQP8R6
- See Appendix B for a copy of Python Spark Code

NOTE:
When I came back and tried to run this later, I got error messages and could not proceed. 
If I had been able to run the code and continue, I would have done the following:
-Idenfified and split the 25 contexts 
-Ordered the results by key-value pairs (where the top users have the highest number of tweets/mentions)

## - ✨Part  3✨

I was able to produce my graph database which represented the network using:

```
load csv with headers from 'https://raw.githubusercontent.com/Knoxyherself/Big-Data-Assignment/main/uu.csv' AS row
CREATE (a:Tweeter { Name:row.from})
CREATE (b:Tweeter { Name:row.to})
CREATE (a)-[r:TWEET {Weight:row.weight}]->(b)
```

After this point, I could not get my code to work, however this is the approach that I took:

Create Cypher Projects for each of the context networks:
```
CALL gds.graph.create.cypher(
    'dry-january-2018',

MATCH (n) RETURN id(n) AS id
MATCH (n)-->(m) RETURN id(n) AS source, id(m) AS target
 ```
 
Then carry out Label Propigation Community Detection:

```
CALL gds.graph.create(
    'myGraph',
    'User',
    'FOLLOW',
    {
        nodeProperties: 'seed_label',
        relationshipProperties: 'weight'
    }
)

```
Then carry out Degree Centrality for each node:

```
CALL gds.alpha.degree.write(configuration: Map)
YIELD nodes, createMillis, computeMillis, writeMillis, writeProperty, centralityDistribution
```


## - ✨Appendix A - Pig Scripts✨

TWEET

```Define CSVLoader org.apache.pig.piggybank.storage.CSVLoader();                                                                 
TWEET = LOAD 'hdfs://sandbox-hdp.hortonworks.com:8020/user/coursework/data/data/TWEET*.csv' USING CSVLoader()                  
AS (index:int,context:chararray,date:chararray,tw_id:chararray,is_media:chararray,is_retweet:chararray,no_likes:chararray,no_re
tweets:chararray,reply:chararray,text:chararray,user_name:chararray);                                                          
DESCRIBE TWEET;                                                                                                                
STORE TWEET INTO 'root/user/Uni_Assignment/TWEET' USING PigStorage('|'); 
```

RETWEET

```Define CSVLoader org.apache.pig.piggybank.storage.CSVLoader();                                                                 
RETWEET = LOAD 'hdfs://sandbox-hdp.hortonworks.com:8020/user/coursework/data/data/RETWEET*.csv' USING CSVLoader()              
AS (index:int,rt_id:chararray,context:chararray,rt_user:chararray,tw_id:chararray);                                            
DESCRIBE RETWEET;                                                                                                              
STORE RETWEET INTO 'root/user/Uni_Assignment/RETWEET' USING PigStorage('|'); 
```

MENTIONS

```Define CSVLoader org.apache.pig.piggybank.storage.CSVLoader();                                                                 
MENTIONS = LOAD 'hdfs://sandbox-hdp.hortonworks.com:8020/user/coursework/data/data/MENTIONS*.csv' USING CSVLoader()            
AS (index:int,context:chararray,mentions:chararray,tw_id:chararray);                                                           
DESCRIBE MENTIONS;                                                                                                             
STORE MENTIONS INTO 'root/user/Uni_Assignment/MENTIONS' USING PigStorage('|'); 
```

HASHTAGS_TIMELINES

```Define CSVLoader org.apache.pig.piggybank.storage.CSVLoader();                                                                 
HASHTAGS_TIMELINES = LOAD 'hdfs://sandbox-hdp.hortonworks.com:8020/user/coursework/data/data/HASHTAGS_TIMELINES.csv'           
USING CSVLoader()                                                                                                              
AS (index:int,hashtag:chararray,tw_id:chararray,user_id:chararray);                                                            
DESCRIBE HASHTAGS_TIMELINES;                                                                                                   
STORE HASHTAGS_TIMELINES INTO 'root/user/Uni_Assignment/HASHTAGS_TIMELINES' USING PigStorage('|');  
```

TWEET_RETWEET

```Define CSVLoader org.apache.pig.piggybank.storage.CSVLoader();                                                                 
tweetage = LOAD 'hdfs://sandbox-hdp.hortonworks.com:8020/user/coursework/data/data/TWEET*.csv' USING CSVLoader();              
tweetraw = FILTER tweetage BY $0>1;                                                                                            
tweetdetails = FOREACH tweetraw GENERATE $0 AS index, $1 AS context, $2 AS date, $3 AS tw_id, $4 AS is_media, $5 AS is_retweet,
 $6 AS no_likes, $7 AS no_retweets, $8 AS reply, $9 AS text, $10 AS user_name;                                                 
                                                                                                                               
retweetage = LOAD 'hdfs://sandbox-hdp.hortonworks.com:8020/user/coursework/data/data/RETWEET*.csv' USING CSVLoader();          
retweetraw = FILTER retweetage BY $0>1;                                                                                        
retweetdetails = FOREACH retweetraw GENERATE $0 AS index, $1 AS rt_id, $2 AS context, $3 AS rt_user, $4 AS tw_id;              
                                                                                                                               
jointweetretweet = JOIN tweetdetails by tw_id, retweetdetails by tw_id;                                                        
TWEET_RETWEET = FOREACH jointweetretweet GENERATE $0 AS index, $1 AS tw_id, $2 AS mentions, $3 AS rt_id, $4 AS rt_user, $5 AS d
ate, $6 AS context, $7 AS is_media, $8 AS is_retweet,  $9 AS no_likes, $10 AS no_retweets, $11 AS reply, $12 AS text, $13 AS us
er_name;                                                                                                                       
                                                                                                                               
DESCRIBE TWEET_RETWEET;                                                                                                        
STORE TWEET_RETWEET INTO 'root/user/Uni_Assignment/TWEET_RETWEET' USING PigStorage('|');
```

